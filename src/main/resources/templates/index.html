<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HBMP - Năng Lượng Mặt Trời | Giải Pháp Điện Mặt Trời Uy Tín</title>

    <!-- SEO Meta Tags -->
    <meta name="description"
        content="HBMP Solar chuyên cung cấp giải pháp điện năng lượng mặt trời uy tín, chất lượng cao. Lắp đặt hệ thống điện mặt trời áp mái, hòa lưới, hybrid cho gia đình và doanh nghiệp.">
    <meta name="keywords"
        content="điện mặt trời, năng lượng mặt trời, HBMP solar, pin mặt trời, inverter solar, điện mặt trời áp mái, lắp đặt điện mặt trời">
    <meta name="author" content="HBMP Solar">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hbmp.com.vn/">
    <meta property="og:title" content="HBMP - Giải Pháp Năng Lượng Mặt Trời Toàn Diện">
    <meta property="og:description"
        content="Đối tác tin cậy cung cấp thiết bị và giải pháp điện năng lượng mặt trời hàng đầu Việt Nam.">
    <meta property="og:image" content="/photo/anh7.jpg">

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "HBMP Solar",
      "url": "https://hbmp.com.vn",
      "logo": "https://hbmp.com.vn/photo/logo-hbmp.png",
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+84-0915-060-789",
        "contactType": "customer service"
      }
    }
    </script>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom CSS -->
    <link th:href="@{/css/style.css}" rel="stylesheet">
</head>

<body>
    <!-- Header -->
    <div th:replace="~{layout/header :: header}"></div>

    <!-- Banner Slider (datsolar format) -->
    <section class="banner_slider section">
        <div class="banner">
            <img th:src="@{/photo/anh7.1.jpg}" alt="HBMP Solar Farm">
            <div class="container grid-container">
                <div class="content_banner">
                    <h2 data-i18n="home.banner.title">CHÚNG TÔI LÀ ĐƠN VỊ HỮU HIỆU TRONG LĨNH VỰC NĂNG LƯỢNG MẶT TRỜI
                    </h2>
                    <a href="#" class="button_style" data-i18n="home.banner.cta">KHÁM PHÁ THẾ GIỚI NĂNG LƯỢNG XANH CÙNG
                        HBMP SOLAR</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Statistics Section (Separate from Banner) -->
    <section class="statistics-section-new py-5 bg-white">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <div class="stat-card text-center border-0 shadow-sm p-4">
                        <div class="stat-icon mb-3">
                            <i class="fas fa-solar-panel text-warning fa-3x"></i>
                        </div>
                        <div class="stat-number h2 fw-bold text-primary" th:text="${totalCapacity}">1+</div>
                        <div class="stat-unit fw-bold" th:text="${totalCapacityUnit}"
                            data-i18n="home.stats.capacity_unit">GWP</div>
                        <div class="stat-label text-muted" data-i18n="home.stats.capacity">TỔNG CÔNG SUẤT</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card text-center border-0 shadow-sm p-4">
                        <div class="stat-icon mb-3">
                            <i class="fas fa-building text-warning fa-3x"></i>
                        </div>
                        <div class="stat-number h2 fw-bold text-primary" th:text="${totalProjects}">12.000+</div>
                        <div class="stat-unit fw-bold" th:text="${projectsUnit}" data-i18n="home.stats.systems_unit">HỆ
                            THỐNG</div>
                        <div class="stat-label text-muted" data-i18n="home.stats.systems">HỆ THỐNG ĐÃ LẮP ĐẶT</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card text-center border-0 shadow-sm p-4">
                        <div class="stat-icon mb-3">
                            <i class="fas fa-users text-warning fa-3x"></i>
                        </div>
                        <div class="stat-number h2 fw-bold text-primary" th:text="${totalEmployees}">2.000+</div>
                        <div class="stat-unit fw-bold" th:text="${employeesUnit}" data-i18n="home.stats.partners_unit">
                            ĐỐI TÁC</div>
                        <div class="stat-label text-muted" data-i18n="home.stats.partners">ĐỐI TÁC PHÂN PHỐI</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- About HBMP Section -->
    <section class="about-section-new">
        <div class="about-container">
            <div class="about-grid">
                <!-- Left Side - Content -->
                <div class="about-left">
                    <h2 class="about-title"><span class="title-underline" data-i18n="home.about.title">VỀ HBMP</span>
                    </h2>
                    <p class="about-description">
                        HBMP là Tập đoàn công nghệ – thương mại dịch vụ có quy mô, uy tín dẫn đầu Việt Nam trong
                        lĩnh vực tự động hóa công nghiệp và năng lượng tái tạo. Trong đó, HBMP chuyên cung cấp các
                        giải pháp năng lượng mặt trời như: <em>Điện năng lượng mặt trời; tấm pin năng lượng mặt trời;
                            pin lưu trữ năng lượng mặt trời; đèn năng lượng mặt trời.</em> Chúng tôi không ngừng tiên
                        phong kiến tạo Hệ sinh thái, gia tăng hiệu quả, mang đến giá trị tối ưu cho khách hàng, đối tác.
                    </p>

                    <div class="about-highlight-box">
                        <p>
                            HBMP đã cung cấp và triển khai hơn <strong>12.000 hệ thống</strong> điện năng lượng mặt
                            trời có tổng công suất hơn <strong>1+ GWP</strong>, mang đến cho khách hàng, đối tác và nhà
                            đầu tư những giải pháp điện mặt trời thông minh, <em>tối ưu chi phí đầu tư nhưng vẫn đảm bảo
                                tính hiệu quả cao.</em>
                        </p>
                    </div>
                </div>

                <!-- Right Side - Image with Badge -->
                <div class="about-right">
                    <div class="about-image-container">
                        <div class="about-image-wrapper">
                            <img th:src="@{/photo/anh8.jpg}" alt="HBMP Solar Engineers" class="about-main-image">
                            <div class="hbmp-logo-overlay">
                                <span class="hbmp-logo-text">HBMP</span>
                            </div>
                        </div>

                        <!-- Orange Overlay Box - positioned to overlap -->
                        <div class="experience-orange-box">
                            <div class="circle-pattern"></div>
                            <div class="orange-box-content">
                                <span class="big-number">19<sup>+</sup></span>
                                <div class="box-text">
                                    <span data-i18n="home.about.exp_years">NĂM KINH NGHIỆM PHÁT</span>
                                    <span data-i18n="home.about.exp_sustainable">TRIỂN BỀN VỮNG</span>
                                </div>
                                <a href="#" class="cta-link">
                                    <span data-i18n="home.about.profile_cta">HỒ SƠ NĂNG LỰC</span>
                                    <div class="plus-icon-circle">
                                        <i class="fas fa-plus"></i>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Solutions Section -->
    <section class="solutions-section-new">
        <div class="solutions-container">
            <div class="solutions-grid">
                <!-- Left Side - Categories -->
                <div class="solutions-left">
                    <h2 class="solutions-main-title" data-i18n="home.solutions_title">
                        GIẢI PHÁP ĐIỆN<br>
                        NĂNG LƯỢNG<br>
                        MẶT TRỜI
                    </h2>
                    <p class="solutions-description" data-i18n="home.solutions_subtitle">
                        HBMP hiểu rõ những lợi ích của việc ứng dụng nguồn năng lượng mặt trời vào nhiều lĩnh vực khác
                        nhau của cuộc sống.
                    </p>

                    <!-- Categories Grid -->
                    <div class="solution-categories-grid">
                        <!-- Doanh nghiệp -->
                        <div class="solution-cat-item active" data-category="business">
                            <span class="cat-title" data-i18n="nav.enterprise">Doanh nghiệp</span>
                            <div class="cat-icon-wrapper">
                                <img th:src="@{/photo/icon-doanh-nghiep.png}" alt="Doanh nghiệp"
                                    style="filter: brightness(0);">
                            </div>
                            <i class="fas fa-chevron-right cat-arrow"></i>
                        </div>

                        <!-- Hộ gia đình -->
                        <div class="solution-cat-item" data-category="household">
                            <span class="cat-title" data-i18n="nav.household">Hộ gia đình</span>
                            <div class="cat-icon-wrapper">
                                <img th:src="@{/photo/icon-ho-gia-dinh.png}" alt="Hộ gia đình"
                                    style="filter: brightness(0);">
                            </div>
                            <i class="fas fa-chevron-right cat-arrow"></i>
                        </div>

                        <!-- Nông nghiệp -->
                        <div class="solution-cat-item" data-category="agriculture">
                            <span class="cat-title" data-i18n="nav.agriculture">Nông nghiệp</span>
                            <div class="cat-icon-wrapper">
                                <img th:src="@{/photo/icon-nong-nghiep.png}" alt="Nông nghiệp"
                                    style="filter: brightness(0);">
                            </div>
                            <i class="fas fa-chevron-right cat-arrow"></i>
                        </div>
                    </div>
                </div>

                <!-- Right Side - Solution Detail -->
                <div class="solutions-right">
                    <div class="solution-detail-card">
                        <div class="solution-detail-header">
                            <span class="detail-label">GIẢI PHÁP</span>
                            <h3 class="detail-title">ĐIỆN MẶT TRỜI CHO<br>DOANH NGHIỆP</h3>
                            <p class="detail-desc">
                                Điện mặt trời giúp doanh nghiệp tiết kiệm đến hàng tỷ đồng tiền điện mỗi năm, nâng cao
                                uy tín, giá trị thương hiệu, hướng đến hình ảnh doanh nghiệp xanh thân thiện với môi
                                trường.
                            </p>
                        </div>

                        <div class="solution-stats-section">
                            <div class="solution-stat-item">
                                <span class="stat-upper" data-i18n="home.solutions_detail.usage">SỬ DỤNG</span>
                                <span class="stat-number" id="statUsage">30</span>
                                <span class="stat-lower" data-i18n="home.solutions_detail.year">Năm</span>
                            </div>
                            <div class="solution-stat-item">
                                <span class="stat-upper" data-i18n="home.solutions_detail.payback">HOÀN VỐN</span>
                                <span class="stat-number" id="statPayback">4 – 5</span>
                                <span class="stat-lower" data-i18n="home.solutions_detail.year">Năm</span>
                            </div>
                        </div>

                        <a href="#" class="solution-cta-btn" id="solutionCtaBtn">
                            <i class="fas fa-cog" id="ctaIcon"></i>
                            <span id="ctaText">GIẢI PHÁP<br><strong>ESCO</strong></span>
                        </a>

                        <div class="solution-detail-image">
                            <img th:src="@{/photo/anh10.jpg}" alt="Solar Panel" id="solutionImage">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const catItems = document.querySelectorAll('.solution-cat-item');
            const detailTitle = document.querySelector('.detail-title');
            const detailDesc = document.querySelector('.detail-desc');
            const statUsage = document.getElementById('statUsage');
            const statPayback = document.getElementById('statPayback');
            const ctaBtn = document.getElementById('solutionCtaBtn');
            const ctaIcon = document.getElementById('ctaIcon');
            const ctaText = document.getElementById('ctaText');
            const solutionImage = document.getElementById('solutionImage');

            const categoryData = {
                agriculture: {
                    title: 'ĐIỆN MẶT TRỜI CHO<br>NÔNG NGHIỆP',
                    desc: 'Ứng dụng cho lĩnh vực nông nghiệp, đảm bảo nguồn nước cho việc tưới tiêu, các trạm bơm cấp nước.',
                    usage: '30',
                    payback: '4 – 5',
                    ctaHtml: 'XEM CHI TIẾT <i class="fas fa-arrow-right"></i>',
                    ctaIcon: '',
                    image: '/photo/anh11.jpg',
                    link: '/nong-nghiep'
                },
                household: {
                    title: 'ĐIỆN MẶT TRỜI CHO<br>HỘ GIA ĐÌNH',
                    desc: 'Giải pháp không chỉ mang đến nguồn năng lượng sạch thân thiện với môi trường mà còn tạo ra hiệu quả kinh tế cao cho gia đình Việt, tiết kiệm đáng kể chi phí tiền điện hàng tháng.',
                    usage: '30',
                    payback: '5 – 6',
                    ctaHtml: 'XEM CHI TIẾT <i class="fas fa-arrow-right"></i>',
                    ctaIcon: '',
                    image: '/photo/anh9.jpg',
                    link: '/ho-gia-dinh'
                },
                business: {
                    title: 'ĐIỆN MẶT TRỜI CHO<br>DOANH NGHIỆP',
                    desc: 'Điện mặt trời giúp doanh nghiệp tiết kiệm đến hàng tỷ đồng tiền điện mỗi năm, nâng cao uy tín, giá trị thương hiệu, hướng đến hình ảnh doanh nghiệp xanh thân thiện với môi trường.',
                    usage: '30',
                    payback: '4 – 5',
                    ctaHtml: 'GIẢI PHÁP<br><strong>ESCO</strong>',
                    ctaIcon: 'fas fa-cog',
                    image: '/photo/anh10.jpg',
                    link: '/doanh-nghiep'
                }
            };

            catItems.forEach(item => {
                item.addEventListener('click', function () {
                    catItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');

                    const category = this.dataset.category;
                    if (categoryData[category]) {
                        const data = categoryData[category];
                        detailTitle.innerHTML = data.title;
                        detailDesc.textContent = data.desc;
                        statUsage.textContent = data.usage;
                        statPayback.textContent = data.payback;
                        ctaText.innerHTML = data.ctaHtml;
                        ctaIcon.className = data.ctaIcon;
                        solutionImage.src = data.image;

                        if (data.link) {
                            ctaBtn.href = data.link;
                        }

                        // Change button style for non-business categories
                        if (category === 'business') {
                            ctaBtn.classList.remove('detail-btn');
                        } else {
                            ctaBtn.classList.add('detail-btn');
                        }
                    }
                });
            });

            // Initialize with active category
            const activeItem = document.querySelector('.solution-cat-item.active');
            if (activeItem) {
                const category = activeItem.dataset.category;
                if (categoryData[category] && categoryData[category].link) {
                    ctaBtn.href = categoryData[category].link;
                }
            }
        });
    </script>

    <!-- Featured Projects Section -->
    <section class="projects-section-new"
        style="background-image: url('/photo/2-layersfse.jpg'); background-size: cover; background-attachment: fixed;">
        <div class="projects-container">
            <h2 class="projects-title" data-i18n="home.projects_title">DỰ ÁN ĐÃ THỰC HIỆN</h2>
            <p class="projects-subtitle" data-i18n="home.projects_subtitle">
                Chúng tôi cam kết phục vụ khách hàng bằng cả "trái tim" của sự nhiệt huyết và tinh thần trách nhiệm cao!
            </p>

            <!-- Filter Buttons -->
            <div class="project-filter-buttons">
                <button class="filter-btn active" data-filter="all">DOANH NGHIỆP</button>
                <button class="filter-btn" data-filter="household">HỘ GIA ĐÌNH</button>
                <button class="filter-btn" data-filter="agriculture">NÔNG NGHIỆP</button>
            </div>

            <!-- Projects Slider -->
            <div class="projects-slider-wrapper">
                <!-- Left Arrow -->
                <button class="project-nav-btn project-prev" id="projectPrev">
                    <i class="fas fa-chevron-left"></i>
                </button>

                <!-- Slider Container -->
                <div class="projects-slider" id="projectsSlider">
                    <!-- Project 1 -->
                    <div class="project-slide side-slide">
                        <img th:src="@{/photo/anh10.jpg}" alt="Dự án 1">
                    </div>

                    <!-- Main Project (Center) -->
                    <div class="project-slide main-slide">
                        <img th:src="@{/photo/anh18.jpg}" alt="Nhà máy giày Đại Lộc">
                        <div class="project-slide-overlay">
                            <span class="project-category">DOANH NGHIỆP</span>
                            <h3 class="project-name">NHÀ MÁY GIÀY ĐẠI LỘC – BÌNH DƯƠNG</h3>
                            <div class="project-stats-row">
                                <div class="stat-box">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span class="stat-label" data-i18n="home.project_card.year">Năm thi công</span>
                                    <span class="stat-value">2020</span>
                                </div>
                                <div class="stat-box">
                                    <i class="fas fa-bolt"></i>
                                    <span class="stat-label" data-i18n="home.project_card.power">Công suất</span>
                                    <span class="stat-value">1 MWp</span>
                                </div>
                                <div class="stat-box">
                                    <i class="fas fa-sun"></i>
                                    <span class="stat-label" data-i18n="home.project_card.production">Sản
                                        lượng/năm</span>
                                    <span class="stat-value">1.440 MWh</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Project 3 -->
                    <div class="project-slide side-slide">
                        <img th:src="@{/photo/anh19.jpg}" alt="Dự án 3">
                    </div>
                </div>

                <!-- Right Arrow -->
                <button class="project-nav-btn project-next" id="projectNext">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const projectSlider = document.getElementById('projectsSlider');
            const projectPrev = document.getElementById('projectPrev');
            const projectNext = document.getElementById('projectNext');

            // --- Server Data Integration ---
            /*[+
            const serverProjects = [[${projects}]];
            +]*/
            // Fallback if null (though controller ensures it's not null, good for safety)
            const rawProjects = (typeof serverProjects !== 'undefined' && serverProjects) ? serverProjects : [];

            // Helper to get display category
            function getCategoryDisplay(appEnum) {
                const map = {
                    'HO_GIA_DINH': 'HỘ GIA ĐÌNH',
                    'DOANH_NGHIEP': 'DOANH NGHIỆP',
                    'NONG_NGHIEP': 'NÔNG NGHIỆP',
                    'CONG_TRINH_CONG': 'CÔNG TRÌNH'
                };
                return map[appEnum] || appEnum || 'DOANH NGHIỆP';
            }

            // Map server data to slider format
            const allProjects = rawProjects.map(p => ({
                img: p.imageUrl || '/photo/anh10.jpg',
                name: p.name,
                category: getCategoryDisplay(p.application),
                originalCategory: p.application, // store enum for filtering
                year: p.createdAt ? new Date(p.createdAt).getFullYear() : '2023',
                power: p.power ? p.power + ' kWp' : 'N/A',
                production: 'N/A' // Field doesn't exist in entity
            }));

            // If no data from server, use fallback (keeping existing logic for demo if DB empty)
            let projects = allProjects.length > 0 ? allProjects : [
                { img: '/photo/anh10.jpg', name: 'MẪU - CÔNG TY TNHH ABC', category: 'DOANH NGHIỆP', originalCategory: 'DOANH_NGHIEP', year: '2019', power: '800 kWp', production: '1.150 MWh' },
                { img: '/photo/anh18.jpg', name: 'MẪU - NHÀ MÁY ĐẠI LỘC', category: 'DOANH NGHIỆP', originalCategory: 'DOANH_NGHIEP', year: '2020', power: '1 MWp', production: '1.440 MWh' },
                { img: '/photo/anh21.jpg', name: 'MẪU - TRANG TRẠI TÂY NINH', category: 'NÔNG NGHIỆP', originalCategory: 'NONG_NGHIEP', year: '2023', power: '5 MWp', production: '7.200 MWh' }
            ];

            // Allow for filtering - maintain a current filtered list
            let filteredProjects = [...projects];
            let currentIndex = 0;

            function updateSlider() {
                if (filteredProjects.length === 0) return; // Handle empty state if needed

                const slides = projectSlider.querySelectorAll('.project-slide');

                // Safety check: ensure we have at least 1 project, repeat if needed to fill 3 slots? 
                // The existing CSS logic relies on prev/main/next. 
                // We really need at least 1 item.

                const count = filteredProjects.length;
                let prevIdx = (currentIndex - 1 + count) % count;
                let nextIdx = (currentIndex + 1) % count;

                // If only 1 item
                if (count === 1) { prevIdx = 0; nextIdx = 0; }

                // Update side slides
                slides[0].querySelector('img').src = filteredProjects[prevIdx].img;
                slides[2].querySelector('img').src = filteredProjects[nextIdx].img;

                // Update main slide
                const mainSlide = slides[1];
                const currentProj = filteredProjects[currentIndex];

                mainSlide.querySelector('img').src = currentProj.img;
                mainSlide.querySelector('img').alt = currentProj.name;
                mainSlide.querySelector('.project-category').textContent = currentProj.category;
                mainSlide.querySelector('.project-name').textContent = currentProj.name;

                const stats = mainSlide.querySelectorAll('.stat-value');
                if (stats.length >= 3) {
                    stats[0].textContent = currentProj.year;
                    stats[1].textContent = currentProj.power;
                    stats[2].textContent = currentProj.production;
                }
            }

            if (projectPrev && projectNext) {
                projectPrev.addEventListener('click', function () {
                    if (filteredProjects.length === 0) return;
                    currentIndex = (currentIndex - 1 + filteredProjects.length) % filteredProjects.length;
                    updateSlider();
                });

                projectNext.addEventListener('click', function () {
                    if (filteredProjects.length === 0) return;
                    currentIndex = (currentIndex + 1) % filteredProjects.length;
                    updateSlider();
                });
            }

            // --- Filtering Logic ---
            const filterBtns = document.querySelectorAll('.filter-btn');

            // Map data-filter to Enum
            const filterMap = {
                'all': null, // Show all
                'household': 'HO_GIA_DINH',
                'agriculture': 'NONG_NGHIEP',
                'business': 'DOANH_NGHIEP' // Default active was 'Doanh nghiệp' but button says data-filter="all"? 
                // Looking at HTML: Button "DOANH NGHIỆP" has data-filter="all" (Wait, that's wrong conceptually if it says Enterprise).
                // Existing HTML: <button ... data-filter="all">DOANH NGHIỆP</button>
                // This seems like the user intended "All" to be the default tab labeled "Doanh nghiệp"? 
                // No, standard UX: "All Projects" or specific tabs.
                // Let's assume the labels in HTML are what we want: "DOANH NGHIỆP", "HỘ GIA ĐÌNH", "NÔNG NGHIỆP".
                // I should correct the data-filter attributes in the HTML or map them correctly here.
                // HTML: 
                // <button ... data-filter="all">DOANH NGHIỆP</button>  <- This is confusing. 
                // <button ... data-filter="household">HỘ GIA ĐÌNH</button>
                // <button ... data-filter="agriculture">NÔNG NGHIỆP</button>

                // I will assume data-filter="all" was a mistake and should be "enterprise" OR the label "DOANH NGHIỆP" implies the main business category.
                // Given the user request: "data thật... đối với từng doanh nghiệp/hộ gia đình/ nông nghiệp"
                // It implies 3 distinct categories.
                // I will treat the first button as "Enterprise" filter.
            };

            filterBtns.forEach(btn => {
                btn.addEventListener('click', function () {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');

                    const filterKey = this.getAttribute('data-filter');

                    // Logic correction: Map "all" to DOANH_NGHIEP if the label says so, OR if it really means ALL.
                    // Given the label is "DOANH NGHIỆP", I will filter by DOANH_NGHIEP.
                    // But if I want to support "ALL", I'd need a button for it.
                    // Current buttons: [DOANH NGHIỆP] [HỘ GIA ĐÌNH] [NÔNG NGHIỆP]

                    let targetEnum = null;
                    if (filterKey === 'all' || filterKey === 'enterprise') targetEnum = 'DOANH_NGHIEP';
                    else if (filterKey === 'household') targetEnum = 'HO_GIA_DINH';
                    else if (filterKey === 'agriculture') targetEnum = 'NONG_NGHIEP';

                    if (targetEnum) {
                        filteredProjects = projects.filter(p => p.originalCategory === targetEnum);
                    } else {
                        filteredProjects = [...projects]; // Fallback to all if something weird
                    }

                    // If filtered list is empty, maybe show all or show placeholder?
                    // For now, if empty, we just don't crash, maybe keep previous? 
                    // Better to clear or show empty state. 
                    if (filteredProjects.length === 0) {
                        // Fallback to show active projects from other categories just to not show empty slider? 
                        // No, correct is to show nothing or message. 
                        // I'll leave it empty but handle index 0.
                    }

                    currentIndex = 0;
                    updateSlider();
                });
            });

            // Initial render
            // Trigger click on active button to run filter logic
            const activeBtn = document.querySelector('.filter-btn.active');
            if (activeBtn) activeBtn.click();
            else updateSlider(); // Fallback
        });
    </script>

    <!-- Products Section (Refactored to Datsolar Layout with Specific Categories) -->
    <section class="products-section section" style="padding: 50px 0;">
        <div class="container datsolar-grid-container">
            <h2 class="text-center mb-5"
                style="font-weight: bold; font-size: 30px; color: #222; text-transform: uppercase;"
                data-i18n="home.products_title">SẢN PHẨM NỔI BẬT
            </h2>

            <div class="row">
                <!-- Left Side: Category Grid (Navigation) -->
                <div class="col-lg-4 col-md-12 mb-4">
                    <div class="product-category-grid">
                        <div class="product_tab_box">
                            <!-- Category 1: Tấm pin năng lượng mặt trời -->
                            <div class="product_tab_icon active"
                                onclick="switchProductCategory('Tấm pin năng lượng mặt trời', this)">
                                <div class="button_tab_box">
                                    <h4>Tấm pin năng lượng mặt trời</h4>
                                    <img th:src="@{/photo/tam-pin.png}" alt="Solar Panel">
                                </div>
                            </div>

                            <!-- Category 2: Inverter hòa lưới -->
                            <div class="product_tab_icon" onclick="switchProductCategory('Inverter hòa lưới', this)">
                                <div class="button_tab_box">
                                    <h4>Inverter hòa lưới</h4>
                                    <img th:src="@{/photo/inverter.png}" alt="Inverter">
                                </div>
                            </div>

                            <!-- Category 3: Inverter Hybrid & Lưu trữ -->
                            <div class="product_tab_icon"
                                onclick="switchProductCategory('Inverter Hybrid & Lưu trữ', this)">
                                <div class="button_tab_box">
                                    <h4>Inverter Hybrid & Lưu trữ</h4>
                                    <img th:src="@{/photo/pin-luu-tru.png}" alt="Hybrid">
                                </div>
                            </div>

                            <!-- Category 4: Đèn năng lượng mặt trời -->
                            <div class="product_tab_icon"
                                onclick="switchProductCategory('Đèn năng lượng mặt trời', this)">
                                <div class="button_tab_box">
                                    <h4>Đèn năng lượng mặt trời</h4>
                                    <img th:src="@{/photo/den-nang-luong.png}" alt="Light">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Side: Product Display Area -->
                <div class="col-lg-8 col-md-12">
                    <div class="product-display-area">
                        <!-- Horizontal Scrollable Products Container -->
                        <div class="product-horizontal-scroll" id="productGridContainer">
                            <!-- Dynamic Products Loop -->
                            <div th:each="product : ${featuredProducts}" class="product-card-horizontal product-item"
                                th:data-category="${(product.category != null && !product.category.isEmpty()) ? product.category : ((product.type != null) ? product.type : 'other')}"
                                th:data-name="${product.name}">
                                <div class="product_tab_item_box">
                                    <div class="product_tab_item_img">
                                        <a th:href="@{/products/{id}(id=${product.id})}">
                                            <img th:src="@{${product.imageUrl != null ? product.imageUrl : '/photo/anh31.jpg'}}"
                                                th:alt="${product.name}" onerror="this.src='/photo/anh31.jpg'">
                                        </a>
                                    </div>
                                    <div class="product_tab_item_content">
                                        <h4>
                                            <a th:href="@{/products/{id}(id=${product.id})}" th:text="${product.name}"
                                                style="font-weight: bold; color: #222; font-size: 1.1rem;">Product
                                                Name</a>
                                        </h4>
                                        <p class="mb-2" th:text="${product.description}"
                                            style="display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; font-size: 0.9em; color: #555;">
                                            Description</p>
                                        <div class="product-specs-home">
                                            <p class="mb-1" style="color: #444;">
                                                <b style="font-weight: 700;">Công suất:</b> <span
                                                    th:text="${product.power + ' ' + (product.powerUnit != null ? product.powerUnit : 'W')}"
                                                    style="font-weight: 400;">450W</span>
                                            </p>
                                            <p class="mb-1" style="color: #444;">
                                                <b style="font-weight: 700;">Hãng:</b> <span th:text="${product.brand}"
                                                    style="font-weight: 400;">Canadian Solar</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- No match in category message -->
                            <div id="noMatchMessage" class="text-center py-5 d-none" style="min-width: 100%;">
                                <p class="text-muted">Chưa có sản phẩm nào trong danh mục này.</p>
                            </div>

                            <!-- Fallback if no products in database -->
                            <div th:if="${featuredProducts == null or featuredProducts.isEmpty()}"
                                class="text-center py-5" style="min-width: 100%;">
                                <p class="mb-2">Chưa tìm thấy sản phẩm nổi bật nào.</p>
                                <small class="text-muted d-block">Lưu ý: Sản phẩm phải được tích chọn <strong>"Hoạt
                                        động"</strong> VÀ <strong>"Sản phẩm nổi bật"</strong> để hiển thị ở đây.</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        function switchProductCategory(categoryName, element) {
            // 1. Visual Tab State
            document.querySelectorAll('.product_tab_icon').forEach(el => el.classList.remove('active'));
            if (element) element.classList.add('active');

            // 2. Filter Logic
            const items = document.querySelectorAll('.product-item');
            const noMatchMsg = document.getElementById('noMatchMessage');

            const targetKeywords = categoryName.toLowerCase().split(/[ \s&]+/).filter(k => k.length > 2);

            let visibleCount = 0;

            items.forEach(item => {
                const itemCat = (item.getAttribute('data-category') || '').toLowerCase();
                const itemName = (item.getAttribute('data-name') || '').toLowerCase();

                let match = false;
                if (targetKeywords.length === 0) {
                    match = itemCat.includes(categoryName.toLowerCase()) || itemName.includes(categoryName.toLowerCase());
                } else {
                    match = targetKeywords.some(kw => itemCat.includes(kw) || itemName.includes(kw));
                }

                if (match) {
                    item.style.display = 'flex';
                    visibleCount++;
                } else {
                    item.style.display = 'none';
                }
            });

            if (noMatchMsg) {
                if (visibleCount === 0 && items.length > 0) {
                    noMatchMsg.classList.remove('d-none');
                } else {
                    noMatchMsg.classList.add('d-none');
                }
            }
        }

        // Initialize: Show ALL featured products by default on load
        document.addEventListener('DOMContentLoaded', () => {
            // We don't filter on load anymore to ensure products are visible if categories mismatch
            // But we still want to keep the "Active" visual state if we can't show all
            // Let's just leaved it as is - all items have style="display: block" in HTML above.

            // Optional: if you want a specific tab active but showing all:
            // document.querySelectorAll('.product_tab_icon').forEach(el => el.classList.remove('active'));
        });
    </script>

    <!-- News Section -->
    <section class="news-section-new"
        style="background-image: url('/photo/2-layersfse.jpg'); background-size: cover; background-attachment: fixed;">
        <div class="news-container">
            <!-- Header -->
            <div class="news-header">
                <h2 class="news-section-title" data-i18n="home.news_title">TIN TỨC & SỰ KIỆN</h2>
                <a th:href="@{/news}" class="news-view-all-btn">
                    <span data-i18n="home.news_view_all">TẤT CẢ TIN TỨC</span> <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <div class="news-content-wrapper" th:if="${recentNews != null and !recentNews.isEmpty()}">
                <!-- Featured News (Left Side) -->
                <div class="news-featured" th:if="${recentNews.size() > 0}" th:with="featuredNews=${recentNews[0]}">
                    <div class="featured-text">
                        <span class="featured-date" th:text="${featuredNews.publishedDateFormatted}">01.07.2025</span>
                        <h3 class="featured-title">
                            <a th:href="@{/news/{id}(id=${featuredNews.id})}" th:text="${featuredNews.title}">
                                HBMP Hợp Tác Với Lithium Valley – Lưu Trữ Điện Dân Dụng
                            </a>
                        </h3>
                        <p class="featured-excerpt" th:text="${featuredNews.shortDescription}">
                            Trong bối cảnh nhu cầu sử dụng điện mặt trời dân dụng ngày càng gia tăng, HBMP tự hào
                            chính thức hợp tác chiến lược...
                        </p>
                        <a th:href="@{/news/{id}(id=${featuredNews.id})}" class="featured-cta">
                            XEM THÊM <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                    <div class="featured-image">
                        <img th:src="@{${featuredNews.imageUrl != null ? featuredNews.imageUrl : '/photo/anh39.jpg'}}"
                            th:alt="${featuredNews.title}">
                        <div class="featured-image-overlay">
                            <span class="overlay-link">TÌM HIỂU NGAY</span>
                            <span class="overlay-hotline">www.hbmp.com.vn | Hotline: 1800 6567</span>
                        </div>
                    </div>
                </div>

                <!-- News Grid (Right Side) -->
                <div class="news-grid-new">
                    <!-- News Item 1 -->
                    <div class="news-grid-item" th:if="${recentNews.size() > 1}" th:with="news=${recentNews[1]}">
                        <div class="grid-item-image">
                            <a th:href="@{/news/{id}(id=${news.id})}">
                                <img th:src="@{${news.imageUrl != null ? news.imageUrl : '/photo/anh40.jpg'}}"
                                    th:alt="${news.title}">
                            </a>
                        </div>
                        <div class="grid-item-content">
                            <span class="grid-item-date" th:text="${news.publishedDateFormatted}">13.06.2025</span>
                            <h4 class="grid-item-title">
                                <a th:href="@{/news/{id}(id=${news.id})}" th:text="${news.title}">
                                    Năng lượng mặt trời là gì? Khám phá nguồn năng lượng sạch
                                </a>
                            </h4>
                        </div>
                    </div>

                    <!-- News Item 2 -->
                    <div class="news-grid-item" th:if="${recentNews.size() > 2}" th:with="news=${recentNews[2]}">
                        <div class="grid-item-image">
                            <a th:href="@{/news/{id}(id=${news.id})}">
                                <img th:src="@{${news.imageUrl != null ? news.imageUrl : '/photo/anh41.jpg'}}"
                                    th:alt="${news.title}">
                            </a>
                        </div>
                        <div class="grid-item-content">
                            <span class="grid-item-date" th:text="${news.publishedDateFormatted}">07.08.2025</span>
                            <h4 class="grid-item-title">
                                <a th:href="@{/news/{id}(id=${news.id})}" th:text="${news.title}">
                                    Solar Light là gì? Cấu tạo và nguyên lý hoạt động chi tiết.
                                </a>
                            </h4>
                        </div>
                    </div>

                    <!-- News Item 3 -->
                    <div class="news-grid-item" th:if="${recentNews.size() > 3}" th:with="news=${recentNews[3]}">
                        <div class="grid-item-image">
                            <a th:href="@{/news/{id}(id=${news.id})}">
                                <img th:src="@{${news.imageUrl != null ? news.imageUrl : '/photo/anh42.jpg'}}"
                                    th:alt="${news.title}">
                            </a>
                        </div>
                        <div class="grid-item-content">
                            <span class="grid-item-date" th:text="${news.publishedDateFormatted}">07.07.2025</span>
                            <h4 class="grid-item-title">
                                <a th:href="@{/news/{id}(id=${news.id})}" th:text="${news.title}">
                                    Năng lượng tái tạo là gì? Khái niệm, định nghĩa và lợi ích
                                </a>
                            </h4>
                        </div>
                    </div>

                    <!-- News Item 4 -->
                    <div class="news-grid-item" th:if="${recentNews.size() > 4}" th:with="news=${recentNews[4]}">
                        <div class="grid-item-image">
                            <a th:href="@{/news/{id}(id=${news.id})}">
                                <img th:src="@{${news.imageUrl != null ? news.imageUrl : '/photo/anh43.jpg'}}"
                                    th:alt="${news.title}">
                            </a>
                        </div>
                        <div class="grid-item-content">
                            <span class="grid-item-date" th:text="${news.publishedDateFormatted}">01.10.2025</span>
                            <h4 class="grid-item-title">
                                <a th:href="@{/news/{id}(id=${news.id})}" th:text="${news.title}">
                                    Bảng giá chi phí lắp điện năng lượng mặt trời giá mới nhất...
                                </a>
                            </h4>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fallback if no news -->
            <div th:if="${recentNews == null or recentNews.isEmpty()}" class="news-fallback">
                <p>Chưa có tin tức nào được đăng. <a th:href="@{/admin}">Đăng nhập admin</a> để thêm tin tức.</p>
            </div>
        </div>
    </section>

    <!-- Strategic Partners Section -->
    <section class="strategic-partners-section">
        <div class="strategic-partners-container">
            <h2 class="strategic-title" data-i18n="home.partners_title">ĐỐI TÁC CHIẾN LƯỢC</h2>
            <p class="strategic-subtitle" data-i18n="home.partners_subtitle">
                Chúng tôi hợp tác với các nhà sản xuất điện tử và nhà phân phối hàng đầu
                toàn thế giới để mang đến cho khách hàng những sản phẩm năng lượng tối ưu.
            </p>

            <div class="strategic-slider-wrapper">
                <!-- Left Arrow -->
                <button class="strategic-nav-btn strategic-prev" id="strategicPrev">
                    <i class="fas fa-chevron-left"></i>
                </button>

                <!-- Slider Container -->
                <div class="strategic-slider" id="strategicSlider">
                    <!-- Partner 1 - SMA -->
                    <div class="strategic-card">
                        <div class="strategic-card-image">
                            <img th:src="@{/photo/anh44.jpg}" alt="SMA Partner">
                        </div>
                        <div class="strategic-card-content">
                            <h4 class="strategic-partner-name">SMA</h4>
                            <p class="strategic-partner-desc">
                                Công ty Inverter SMA Solar Technology AG Đức xuất tiêu chuẩn toàn cầu trong
                                hơn 2,000 nhân viên hoạt động về kỹ thuật năng điện mặt trời
                            </p>
                        </div>
                    </div>

                    <!-- Partner 2 - GoodWe -->
                    <div class="strategic-card">
                        <div class="strategic-card-image">
                            <img th:src="@{/photo/anh45.jpg}" alt="GoodWe Partner">
                        </div>
                        <div class="strategic-card-content">
                            <h4 class="strategic-partner-name">GOODWE</h4>
                            <p class="strategic-partner-desc">
                                GoodWe là một trong những nhà sản xuất inverter điện mặt trời hàng đầu thế giới,
                                được GE Renewable Energy tin chọn và service Machinery Corporation.
                            </p>
                        </div>
                    </div>

                    <!-- Partner 3 - Canadian Solar -->
                    <div class="strategic-card">
                        <div class="strategic-card-image">
                            <img th:src="@{/photo/anh46.jpg}" alt="Canadian Solar Partner">
                        </div>
                        <div class="strategic-card-content">
                            <h4 class="strategic-partner-name">CANADIAN SOLAR</h4>
                            <p class="strategic-partner-desc">
                                Canadian Solar là một trong những công ty năng lượng mặt trời lớn nhất thế giới,
                                chuyên sản xuất tấm pin chất lượng cao.
                            </p>
                        </div>
                    </div>

                    <!-- Partner 4 - INVT -->
                    <div class="strategic-card">
                        <div class="strategic-card-image">
                            <img th:src="@{/photo/anh47.jpg}" alt="INVT Partner">
                        </div>
                        <div class="strategic-card-content">
                            <h4 class="strategic-partner-name">INVT</h4>
                            <p class="strategic-partner-desc">
                                Thành lập 2002, INVT là Tập đoàn quốc tế công nghệ cao trong lĩnh vực lý động hóa
                                công nghiệp, năng lượng điện, điều khiển xe điện và tàu điện cao...
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Right Arrow -->
                <button class="strategic-nav-btn strategic-next" id="strategicNext">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const slider = document.getElementById('strategicSlider');
            const prevBtn = document.getElementById('strategicPrev');
            const nextBtn = document.getElementById('strategicNext');

            if (slider && prevBtn && nextBtn) {
                const cardWidth = 420; // width + gap

                prevBtn.addEventListener('click', function () {
                    slider.scrollBy({ left: -cardWidth, behavior: 'smooth' });
                });

                nextBtn.addEventListener('click', function () {
                    slider.scrollBy({ left: cardWidth, behavior: 'smooth' });
                });
            }
        });
    </script>

    <!-- Footer -->
    <div th:replace="~{layout/footer :: footer}"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script th:src="@{/js/main.js}"></script>
    <script th:src="@{/js/product-scroll.js}"></script>

</body>

</html>