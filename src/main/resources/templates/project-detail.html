<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${project.name + ' - DAT Group'}">Chi tiết dự án</title>
    <meta name="description" th:content="${project.description}">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/css/lightbox.min.css" rel="stylesheet">
    <link th:href="@{/css/style.css}" rel="stylesheet">
</head>

<body>
    <div th:replace="~{layout/header :: header}"></div>

    <!-- HERO BANNER -->
    <div class="hero-banner">
        <img th:src="@{${project.imageUrl != null ? project.imageUrl : '/photo/default-project.jpg'}}" alt="">
        <div class="hero-text-bar">
            <span th:text="${project.name}">Tên dự án</span>
            <span class="mx-3">|</span>
            <span>Trang chủ &gt; Dự án &gt; <span th:text="${project.name}">Chi tiết</span></span>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="container py-5">
        <div class="row">
            <div class="col-lg-5 col-md-6 mb-4">
                <a th:href="@{${project.imageUrl}}" data-lightbox="gallery">
                    <img th:src="@{${project.imageUrl}}" class="img-fluid rounded" alt="">
                </a>
            </div>
            <div class="col-lg-7 col-md-6 mb-4">
                <h1 class="text-primary fw-bold mb-3" th:text="${project.name}">Tên dự án</h1>
                <p class="text-muted" th:text="${project.description}">Mô tả...</p>
            </div>
        </div>

        <!-- GALLERY với nút trái/phải -->
        <div class="gallery-wrapper mt-4" th:if="${project.galleryImages != null and !project.galleryImages.isEmpty()}">
            <button class="gallery-btn" onclick="scrollGallery(-1)"><i class="fas fa-chevron-left"></i></button>
            <div class="gallery-scroll" id="galleryScroll">
                <th:block th:each="img : ${#strings.arraySplit(project.galleryImages, ',')}">
                    <a th:href="@{${img}}" data-lightbox="gallery">
                        <img th:src="@{${img}}" alt="">
                    </a>
                </th:block>
            </div>
            <button class="gallery-btn" onclick="scrollGallery(1)"><i class="fas fa-chevron-right"></i></button>
        </div>
    </div>

    <!-- DETAIL CONTENT - Full width -->
    <div class="detail-content" th:if="${project.detailContent}" th:utext="${project.detailContent}">
    </div>

    <div th:replace="~{layout/footer :: footer}"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/js/lightbox.min.js"></script>
    <script th:src="@{/js/main.js}"></script>
    <script>
        function scrollGallery(dir) {
            const el = document.getElementById('galleryScroll');
            if (el) el.scrollBy({ left: dir * 180, behavior: 'smooth' });
        }

        // Click overlay to close lightbox
        document.addEventListener('click', function (e) {
            if (e.target.classList.contains('lb-overlay') || e.target.id === 'lightbox') {
                document.getElementById('lightbox').style.display = 'none';
                document.querySelector('.lb-overlay').style.display = 'none';
            }
        });

        // Lightbox options
        lightbox.option({
            'resizeDuration': 200,
            'wrapAround': true,
            'albumLabel': 'Ảnh %1 / %2',
            'disableScrolling': true
        });
    </script>

    <style>
        .hero-banner {
            position: relative;
            height: 400px;
            margin-top: 80px;
        }

        .hero-banner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .hero-text-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.6);
            color: #fff;
            padding: 10px 0;
            text-align: center;
            font-size: 0.9rem;
        }

        .gallery-wrapper {
            position: relative;
        }

        .gallery-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: none;
            background: rgba(0, 0, 0, 0.7);
            color: #fff;
            cursor: pointer;
            z-index: 10;
            font-size: 12px;
        }

        .gallery-btn:first-child {
            left: 5px;
        }

        .gallery-btn:last-child {
            right: 5px;
        }

        .gallery-btn:hover {
            background: #000;
        }

        .gallery-scroll {
            display: flex;
            gap: 10px;
            overflow: hidden;
            padding: 5px 35px;
        }

        .gallery-scroll img {
            width: calc(25% - 8px);
            height: 90px;
            object-fit: cover;
            border-radius: 6px;
            flex-shrink: 0;
        }

        .detail-content {
            padding: 30px 40px;
            line-height: 1.8;
            font-size: 1rem;
        }

        .detail-content img {
            max-width: 100%;
            height: auto;
        }

        /* Xóa viền từ Summernote content */
        .detail-content table,
        .detail-content td,
        .detail-content th,
        .detail-content tr {
            border: none !important;
            border-collapse: collapse;
        }

        .detail-content div,
        .detail-content p {
            border: none !important;
        }

        .detail-content thead,
        .detail-content th {
            background: transparent !important;
            background-color: transparent !important;
        }

        .detail-content .box_content {
            display: none !important;
        }

        @media (max-width: 768px) {
            .hero-banner {
                height: 250px;
                margin-top: 70px;
            }

            .hero-text-bar {
                font-size: 0.75rem;
            }
        }

        /* Lightbox Custom */
        .lb-overlay {
            cursor: pointer;
        }

        .lightbox .lb-image {
            max-width: 70vw !important;
            max-height: 70vh !important;
        }

        .lb-container {
            position: relative;
        }

        .lb-nav {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }

        .lb-nav a.lb-prev {
            width: 50px !important;
            left: -60px !important;
            opacity: 1 !important;
        }

        .lb-nav a.lb-next {
            width: 50px !important;
            right: -60px !important;
            opacity: 1 !important;
        }

        .lb-data .lb-close {
            position: absolute;
            top: -40px;
            right: 0;
            display: block !important;
            width: 30px !important;
            height: 30px !important;
            background-size: contain !important;
            cursor: pointer;
        }

        .lb-outerContainer {
            margin: 0 auto;
        }
    </style>
</body>

</html>